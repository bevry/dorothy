#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

remote="$(ask --question='What remote to configure?' --default="${1:-"origin"}" --required)"
protocol="$(git-protocol-ask "${2-}")"

# attempt default, ssh, https
if test "$protocol" = 'ssh'; then
	( \
		silent is-ssh-working \
		&& git-protocol-apply "$remote" ssh \
		&& silent is-ssh-working \
	) || git-protocol-apply "$remote" https
else
	git-protocol-apply "$remote" https
fi

# report
git remote -v
