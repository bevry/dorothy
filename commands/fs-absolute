#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# help
if is-help-empty "$@"; then
	stderr echo-lines \
		'ABOUT:' \
		'Output the absolute path of a relative path.' \
		'' \
		'USAGE:' \
		'fs-absolute <path>' \
		'' \
		'QUIRKS:' \
		'Use [fs-realpath] if you want symlinks resolved.'
	exit 22 # Invalid argument
fi

# options
path="$(ask --question="Enter a relative path to convert into an absolute path, leaving symlinks intact." --default="${1-}" --required)"

# act
# don't use [pwd -P] as -P resolves symlinks
# and resolving symlinks is what [fs-realpath] is for
filename="$(basename "$path")"
if test "$filename" = '..'; then
	cd "$(dirname "$path")/.."
	pwd
elif test "$filename" = '.'; then
	cd "$(dirname "$path")"
	pwd
else
	cd "$(dirname "$path")"
	echo "$(pwd)/$filename"
fi
