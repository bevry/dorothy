#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"
source "$DOROTHY/sources/config.sh"
config_file="$(get_dorothy_config 'shell.sh')"

# dependencies
env QUIET=y setup-util-ripgrep

# prepare
themes=(
	system
	oz
)

# starship
if command-missing starship; then
	if confirm-positive "Would you like to install the starship [https://starship.rs] theme?"; then
		setup-util-starship
	fi
fi
if command-exists starship; then
	themes+=(starship)
fi

# ask
theme="$(choose-option --question='Which theme to use?' -- "${themes[@]}")"

# apply
config-replace "$config_file" 'export DOROTHY_THEME' "export DOROTHY_THEME='$theme'"
echo "Updated [$config_file] to use the theme [$theme]"
