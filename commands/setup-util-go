#!/usr/bin/env bash

# https://go.dev/doc/install
# https://go.dev/dl/

# https://github.com/golang/go/wiki/Ubuntu
# https://go.dev/wiki/Ubuntu

# https://repology.org/project/go/versions

function setup_util_go() (
	source "$DOROTHY/sources/bash.bash"

	# improve performance for detectable utilities with conditional assets
	if setup-util --check --cli=go "$@"; then
		return 0
	fi

	# deps, this is the reason we do the improve performance trick above
	setup-util-devel --quiet

	# despite docs, no apk
	# snap is recommended over apt, so put apt last
	local options=(
		--cli='go'
		--order='... apt'
		"$@"
		APK='go'
		APT_REPO='ppa:longsleep/golang-backports'
		APT='golang-go'
		AUR='go' # is `go` not `go-bin` as repology reports
		BREW='go'
		CHOCO='go'
		DNF='golang'
		GENTOO='dev-lang/go'
		MACPORTS='go'
		NIX='go'
		SCOOP='go'
		SNAP='go --classic'
		SUSE='go'
		VOID='go'
		WINGET='GoLang.Go'
	)
	setup-util "${options[@]}" || return $?
	# not needed, installed fine via apt on wsl:
	#
	# if __is_windows; then
	# 	__print_style --stderr --notice="If golang fails to install, install choco first or install go manually:" --newline \
	# 		--code='   https://chocolatey.org/install#individual' --newline \
	# 		--code='   https://go.dev/dl/'
	# fi
)

# fire if invoked standalone
if [[ $0 == "${BASH_SOURCE[0]}" ]]; then
	setup_util_go "$@"
fi
