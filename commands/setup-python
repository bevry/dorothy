#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# Helper
function pipinstall {
	for ARG in "$@"; do
		pip-install "$ARG"
	done
}

# Ensure pip exists
if ! pipp --version; then
	echo "Could not find pip, installing it manually..."
	d="$(mktemp -d)"
	pushd "$d" || exit 1
	curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
	python get-pip.py --user
	popd || exit 1
fi

# Reload Paths
echo -e '\nReload paths and install latest pip tooling...'
source "$DOROTHY/sources/essentials.sh"
pipinstall pip setuptools

# Reload Paths
echo -e '\nReload paths for latest pip tooling...'
source "$DOROTHY/sources/essentials.sh"

# Install
if is-present "${PYTHON_INSTALL-}"; then
	echo -e '\nInstalling pip packages...'
	pipinstall "${PYTHON_INSTALL[@]}"
fi
