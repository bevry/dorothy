#!/usr/bin/env bash

# https://github.com/googlefonts/noto-emoji/releases

function setup_util_noto_emoji() (
	source "$DOROTHY/sources/bash.bash"

	# improve performance for detectable utilities with conditional assets
	if setup-util "$@" --check --font='NotoColorEmoji.ttf'; then
		return 0
	fi

	# setup
	local options=(
		--name='Noto Emoji'
		--font='NotoColorEmoji.ttf'
		"$@"
		CASK='font-noto-emoji'
	)
	function __get_github_asset_url {
		github-download --dry --slug='googlefonts/noto-emoji' --head --pathname='fonts/NotoColorEmoji.ttf' || return
	}
	function __add_download_option {
		local url
		url="$(__get_github_asset_url)" || return
		options+=(
			DOWNLOAD="$url"
			DOWNLOAD_FILENAME='NotoColorEmoji.ttf'
		)
	}
	__add_download_option || :
	setup-util "${options[@]}"
)

# fire if invoked standalone
if [[ $0 == "${BASH_SOURCE[0]}" ]]; then
	setup_util_noto_emoji "$@"
fi
