#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# inputs
path="$(ask --question="Enter path of the macOS alias file that you want the details for." --default="${1-}" --required)"
# @todo if path is a directory, then get details of all aliases inside the directory

# verify
src="$(alias-verify "$path" || :)"
if test -z "$src"; then
	stderr echo-color \
		--bold+red="$path" \
		$'\t' \
		--error=$'\t← not an alias'
	exit 1
fi

# target
target="$(alias-target "$path" || :)"
if test -z "$target"; then
	stderr echo-color \
		--bold="$src" \
		$'\t' \
		--error=$'\t← target broken'
	exit 1
fi
if test ! -e "$target"; then
	stderr echo-color \
		--bold="$src" \
		--nocolor=$'\t' --color+dim=$'\t→\t' --bold+red="$target" \
		--error=$'\t← target missing'
	exit 1
fi

# success
echo-color \
	--bold="$src" \
	--nocolor=$'\t' --color+dim=$'\t→\t' --bold+green="$target"
