#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

remote="$("$DOROTHY/commands/ask-mandatory" 'What remote to configure?' "${1:-"origin"}")"
url="$("$DOROTHY/commands/ask-mandatory" 'What is the URL to configure the remote to?' "${2-}")"
ourl="$("$DOROTHY/commands/git-remote-url" "$remote")"

git remote remove "$remote"
git remote add "$remote" "$url"

nurl="$("$DOROTHY/commands/git-remote-url" "$remote")"
if test "$nurl" != "$url"; then
	stderr echo "Failed to change remote $remote"
	stderr echo "from  $ourl"
	stderr echo "to    $url"
	stderr echo "is    $nurl"
	exit 1
fi
