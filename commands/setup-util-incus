#!/usr/bin/env bash

function setup_util_incus() (
	source "$DOROTHY/sources/bash.bash"

	# checks
	if ! is-system --debian; then
		__print_style --stderr --notice="[$0] is only intended to be run on Debian systems, skipping." || return $?
		return 0
	fi

	# setup
	# local lts='https://pkgs.zabbly.com/incus/lts-6.0'
	local codename stable='https://pkgs.zabbly.com/incus/stable'
	codename="$(get-system --codename)" || return $?
	local options=(
		--cli='incus'
		"$@"
		APT_KEY='https://pkgs.zabbly.com/key.asc'
		APT_REPO="deb [arch={ARCH} signed-by={KEY}] $stable $codename main"
		APT='incus'
	)
	setup-util "${options[@]}"
)

# fire if invoked standalone
if [[ $0 == "${BASH_SOURCE[0]}" ]]; then
	setup_util_incus "$@"
fi
