#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# prepare
path="$1" # $(ask --question="Enter the path to output the structure of." --default="${1-}" --required)"
args=('-lA')
# -A, --almost-all: do not list implied . and ..
# -l: use a long listing format

# hide the time
if is-mac; then
	# -D format: When printing in the long (-l) format, use format to format the date and time output.  The argument format is a string used by trftime(3).  Depending on the choice of format string, this may result in a different number of columns in the output.  This option overrides the -T option.  This option is not defined in IEEE Std 1003.1-2008 (“POSIX.1”).
	args+=('-D' '')
else
	# --time-style=TIME_STYLE: time/date format with -l; see TIME_STYLE below
	args+=("--time-style=+''")
fi

if test -d "$path"; then
	cd "$path" || exit 1
	ls "${args[@]}"
else
	cd "$(dirname "$path")" || exit 1
	basename="$(basename "$path")"
	# shellcheck disable=SC2012
	ls "${args[@]}" "$basename" | sd -s "$basename" ''
fi
