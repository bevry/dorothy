#!/usr/bin/env bash
source "$DOROTHY/sources/strict.bash"

# only no should be no
# anything that is not no should yes

# escape, n, N should be no
# timeout, enter, y, Y should be yes

# yes being a success exit code (0)
# no being a failure exit code (1)

echo -ne "${1?"USAGE: confirm-positive <message>"} (Y/n) "
ec=0; read -t 60 -r -n 1 answer || ec="$?"
if test "$ec" -gt 128; then
	exit 62 # Timer expired
elif test "$ec" -ne 0; then
	exit "$ec"
fi
echo ""

if test "$answer" = $'\x1b' -o "$answer" = 'n' -o "$answer" = 'N'; then
	exit 1
fi
