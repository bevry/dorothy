#!/usr/bin/env bash

# https://github.com/tonsky/FiraCode/wiki/Installing
# https://github.com/tonsky/FiraCode/wiki/Linux-instructions#installing-with-a-package-manager

function setup_util_fira_code() (
	source "$DOROTHY/sources/bash.bash"

	# improve performance for detectable utilities with conditional assets
	if setup-util "$@" --check --font='FiraCode*'; then
		return 0
	fi

	# setup
	local url=''
	url="$(github-download --dry --slug='tonsky/FiraCode' --latest --asset-regexp='^Fira_Code_v[0-9.]+\.zip$')" || :
	local options=(
		--name='Fira Code'
		--font='FiraCode*'
		"$@"
		CASK='font-fira-code'
		EMERGE='media-fonts/fira-code'
		DNF='fira-code-fonts'
		EOPKG='font-firacode-ttf'
		XBPS='font-firacode'
		DOWNLOAD="$url"
		DOWNLOAD_ARCHIVE_GLOB='{ttf,variable_ttf}/*.ttf'
	)
	setup-util "${options[@]}"
)

# fire if invoked standalone
if [[ $0 == "${BASH_SOURCE[0]}" ]]; then
	setup_util_fira_code "$@"
fi
