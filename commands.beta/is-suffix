#!/usr/bin/env bash

# @todo do tests

function is_suffix() (
	source "$DOROTHY/sources/bash.bash"

	# act
	local needle haystack
	needle="${1:?"USAGE: is-suffix <NEEDLE> <HAYSTACK>"}"
	# trunk-ignore(shellcheck/SC2034)
	haystack="${2:?"USAGE: is-suffix <needle> <HAYSTACK>"}"

	# oldschool way:
	# echo-regexp -q "$needle\$" -- "$haystack" <-- doesn't work, as $needle is not escaped
	# [[ $haystack =~ ^.*$needle$ ]] <-- doesn't work, as $needle is not escaped
	# [[ $haystack =~ ^.*"$needle"$ ]] <-- does this work????

	# better way:
	local suffix
	local -i length=${#needle}
	__slice --source={haystack} --target={suffix} -- "$((length * -1)))" || return
	[[ $needle == "$suffix" ]] || return
)

# fire if invoked standalone
if [[ $0 == "${BASH_SOURCE[0]}" ]]; then
	is_suffix "$@"
fi
