#!/usr/bin/env bash
set -e

if is_empty_string "$1"; then
	echo "USAGE: usesh <shell>"
	exit 1
fi

export shell; shell=$(which "$1")

if ! command_exists "$shell"; then
	echo "ERROR: which for the shell [$1] returned [$shell]"
	exit 1
fi

echo "working with the shell [$shell]"

if cat /etc/shells | contains_line "$shell"; then
	echo "=> already exists in /etc/shells"
else
	echo "=> adding to /etc/shells"
	echo "$shell" | sudo tee -a /etc/shells
fi

echo "=> setting as [$USER]'s login shell"
chpass -u "$USER" -s "$shell"
# chsh is identical to chpass
